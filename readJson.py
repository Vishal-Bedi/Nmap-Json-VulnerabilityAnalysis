import json
import glob
from prettytable import PrettyTable

class my_class(object):
		
	x = PrettyTable()
        x.field_names = ["Instance Address", "High", "Medium", "Low"]
	
	y = PrettyTable()
        y.field_names = ["Date", "High", "Medium", "Low"]

	
	dates = {}
	dates1 = {}
	dates2 = {}
	
        for file1 in glob.glob(r"/root/Downloads/*.json"):
            with open(file1) as data_file:
                data = json.loads(data_file.read())
                
                countH = 0
                countM = 0
                countL = 0 
                severity = ""
                for i in range(len(data["nmaprun"]["host"]["ports"]["port"])):
                    severity = data["nmaprun"]["host"]["ports"]["port"][i]["service"]["@Severity"]
                    if severity.lower() == "high":
                        countH += 1
                    elif severity.lower() == "medium":
                        countM += 1
                    elif severity.lower() == "low":
                        countL += 1

		dateStore = data["nmaprun"]["@date"]
		if dateStore in dates:
			dates[dateStore] += countH 
                        dates1[dateStore] += countM
                        dates2[dateStore] += countL

		else:
			dates[dateStore] = countH
			dates1[dateStore] = countM 
			dates2[dateStore] = countL
			
		x.add_row([data["nmaprun"]["host"]["address"]["@addr"],countH,countM,countL])

	for key,val in dates.items():
		y.add_row([str(key), dates[dateStore],dates1[dateStore],dates2[dateStore]])
	print(x)
	print(y)
